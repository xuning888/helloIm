syntax = "proto3";

option java_package = "com.github.xuning888.helloim.api.protobuf.common.v1";
option java_multiple_files = true;
option java_outer_classname = "CommonProto";

import "google/protobuf/timestamp.proto";

message ImUser {
  int64 userId = 1;
  int32 userType = 2;
  string userName = 3;
  string icon = 4;
  string mobile = 5;
  string deviceId = 6;
  string extra = 7;
  int32 userStatus = 8;
  google.protobuf.Timestamp createdAt = 9;
  google.protobuf.Timestamp updatedAt = 10;
}

enum GateType {
  TCP = 0;
}

message GateUser {
  int64 uid = 1;
  int32 userType = 2;
  string sessionId = 3;
}

message Endpoint {
  string host = 1;
  int32 port = 2;
  GateType gateType = 3;
}


enum GateSessionState {
  CLOSE = 0; // peer 主动断开
  ERROR = 1; // 未知原因断开
  TIMEOUT = 2; // 心跳超时
  LOGOUT = 3; // 登出
}

message GateSessionEvent {
    GateSessionState sessionState = 1;
    GateUser gateUser = 2;
    string traceId = 3;
}

message ImSession {
  string sessionId = 1;
  Endpoint endpoint = 2;
  GateUser gateUser = 3;
}